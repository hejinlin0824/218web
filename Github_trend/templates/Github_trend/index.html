{% extends 'base.html' %}

{% block title %}GitHub è¶‹åŠ¿ - å‘ç°å¼€æºçš„åŠ›é‡{% endblock %}

{% block content %}
<style>
    /* === è¶‹åŠ¿é¡µä¸“ç”¨æ ·å¼ === */

    /* 1. é¡¶éƒ¨ Hero Banner (çº¯å±•ç¤º) */
    .trend-hero {
        background: linear-gradient(135deg, #24292e 0%, #2b3137 100%);
        border-radius: 1rem;
        padding: 3rem 2rem;
        color: white;
        position: relative;
        overflow: hidden; /* ä»…è£åˆ‡èƒŒæ™¯è£…é¥°ï¼Œä¸åŒ…å«äº¤äº’å…ƒç´  */
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    
    .trend-hero::after {
        content: "\f34c"; /* Bootstrap Icons: github */
        font-family: bootstrap-icons !important;
        position: absolute;
        top: -20px;
        right: 20px;
        font-size: 12rem;
        opacity: 0.1;
        transform: rotate(15deg);
        pointer-events: none;
    }

    /* 2. ç‹¬ç«‹ç­›é€‰å·¥å…·æ  (å…³é”®ä¿®å¤) */
    .trend-toolbar {
        background: white;
        padding: 1rem;
        border-radius: 0.8rem;
        box-shadow: 0 2px 10px rgba(0,0,0,0.03);
        border: 1px solid rgba(0,0,0,0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
    }

    /* ç­›é€‰ä¸‹æ‹‰æ¡†ç¾åŒ– */
    .form-select-trend {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 50rem;
        padding: 0.5rem 2rem 0.5rem 1rem;
        font-weight: 600;
        color: #495057;
        cursor: pointer;
        min-width: 140px;
        background-position: right 0.75rem center; /* è°ƒæ•´ç®­å¤´ä½ç½® */
    }
    .form-select-trend:hover {
        background-color: #e9ecef;
        border-color: #dee2e6;
    }
    .form-select-trend:focus {
        box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.1);
        border-color: #0d6efd;
    }

    /* 3. ä»“åº“å¡ç‰‡ */
    .repo-card {
        transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        border: 1px solid rgba(0,0,0,0.05);
        background: white;
        border-radius: 12px;
        height: 100%;
        display: flex;
        flex-direction: column;
    }
    .repo-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 1rem 2rem rgba(0,0,0,0.08) !important;
        border-color: rgba(13, 110, 253, 0.2);
    }

    /* æè¿°æ–‡å­—æˆªæ–­ (æœ€å¤š3è¡Œ) */
    .repo-desc {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
        min-height: 4.5em; 
        color: #6c757d;
        font-size: 0.9rem;
    }

    /* è¯­è¨€åœ†ç‚¹ */
    .lang-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        display: inline-block;
        margin-right: 5px;
    }
</style>

<div class="trend-hero animate__animated animate__fadeIn">
    <div class="position-relative" style="z-index: 1;">
        <h1 class="fw-bold display-5 mb-2">ğŸ”¥ GitHub å¼€æºçƒ­æ¦œ</h1>
        <p class="lead mb-0 opacity-75 fs-6" style="max-width: 600px;">
            å®æ—¶è¿½è¸ªå…¨çƒå¼€å‘è€…çš„å…³æ³¨ç„¦ç‚¹ï¼Œå‘ç°ä¸‹ä¸€ä¸ªç‹¬è§’å…½é¡¹ç›®ã€‚
        </p>
    </div>
</div>

<div class="trend-toolbar mb-4 animate__animated animate__fadeInUp">
    <div class="d-flex align-items-center text-secondary">
        <i class="bi bi-funnel-fill text-primary me-2"></i>
        <span class="fw-bold">ç­›é€‰æ¡ä»¶</span>
    </div>

    <form method="get" class="d-flex align-items-center gap-3 m-0 flex-wrap">
        <div class="d-flex align-items-center">
            <select name="lang" class="form-select form-select-trend" onchange="this.form.submit()">
                {% for lang in language_options %}
                    <option value="{{ lang }}" {% if current_lang == lang %}selected{% endif %}>
                        {{ lang|title }}
                    </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="d-flex align-items-center">
            <select name="period" class="form-select form-select-trend" onchange="this.form.submit()">
                <option value="daily" {% if current_period == 'daily' %}selected{% endif %}>ğŸ“… ä»Šæ—¥çƒ­é—¨</option>
                <option value="weekly" {% if current_period == 'weekly' %}selected{% endif %}>ğŸ“… æœ¬å‘¨çƒ­é—¨</option>
                <option value="monthly" {% if current_period == 'monthly' %}selected{% endif %}>ğŸ“… æœ¬æœˆçƒ­é—¨</option>
            </select>
        </div>
    </form>
</div>

<div class="row g-4">
    {% for repo in repos %}
    <div class="col-md-6 col-lg-4 animate__animated animate__fadeInUp" style="animation-delay: {{ forloop.counter0|add:1 }}00ms;">
        <div class="card repo-card shadow-sm border-0">
            <div class="card-body p-4 d-flex flex-column">
                
                <div class="d-flex align-items-center mb-3">
                    <img src="{{ repo.avatar }}" class="rounded-circle border me-3" width="48" height="48" alt="Owner Avatar" style="object-fit: cover;">
                    <div class="overflow-hidden">
                        <h6 class="fw-bold mb-0 text-truncate text-primary" title="{{ repo.full_name }}">
                            <a href="{{ repo.url }}" target="_blank" class="text-decoration-none text-dark stretched-link">
                                {{ repo.name }}
                            </a>
                        </h6>
                        <small class="text-muted">{{ repo.updated_at }} æ›´æ–°</small>
                    </div>
                </div>

                <p class="repo-desc mb-4 flex-grow-1">
                    {{ repo.description|default:"æš‚æ— æè¿°" }}
                </p>

                <div class="d-flex align-items-center justify-content-between pt-3 border-top mt-auto">
                    <div class="d-flex align-items-center">
                        <div class="d-flex align-items-center me-3 text-warning fw-bold" title="Stars">
                            <i class="bi bi-star-fill me-1"></i> {{ repo.stars }}
                        </div>
                        <div class="d-flex align-items-center text-muted small" title="Language">
                            <span class="lang-dot bg-primary"></span>
                            {{ repo.language|default:"Unknown" }}
                        </div>
                    </div>
                    
                    <a href="{{ repo.url }}" target="_blank" class="btn btn-sm btn-outline-dark rounded-pill px-3 position-relative" style="z-index: 2;">
                        View <i class="bi bi-arrow-right-short"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-12 text-center py-5">
        <div class="display-1 mb-3 opacity-25">ğŸ¦–</div>
        <h4 class="text-muted">å“å‘€ï¼Œç½‘ç»œå¥½åƒå¼€å°å·®äº†</h4>
        <p class="text-secondary">æ— æ³•è·å– GitHub æ•°æ®ï¼Œè¯·ç¨åå†è¯•æˆ–æ£€æŸ¥æœåŠ¡å™¨ç½‘ç»œã€‚</p>
        <a href="?lang=python&period=weekly" class="btn btn-primary rounded-pill px-4 mt-2">é‡ç½®ç­›é€‰</a>
    </div>
    {% endfor %}
</div>

<nav aria-label="Page navigation" class="mt-5 mb-5">
   <ul class="pagination justify-content-center">
      {% if prev_page %}
      <li class="page-item">
        <a class="page-link rounded-start-pill border-0 shadow-sm mx-1 fw-bold" href="?lang={{ current_lang }}&period={{ current_period }}&page={{ prev_page }}">
          &laquo; ä¸Šä¸€é¡µ
        </a>
      </li>
      {% else %}
      <li class="page-item disabled"><span class="page-link border-0 mx-1 bg-transparent text-muted">&laquo; ä¸Šä¸€é¡µ</span></li>
      {% endif %}

      <li class="page-item active">
          <span class="page-link border-0 mx-1 rounded-pill shadow-sm bg-dark border-dark">ç¬¬ {{ current_page }} é¡µ</span>
      </li>

      <li class="page-item">
        <a class="page-link rounded-end-pill border-0 shadow-sm mx-1 fw-bold" href="?lang={{ current_lang }}&period={{ current_period }}&page={{ next_page }}">
          ä¸‹ä¸€é¡µ &raquo;
        </a>
      </li>
   </ul>
</nav>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
{% endblock %}